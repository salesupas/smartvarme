---
phase: 05-design-user-experience
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - wp-content/themes/smartvarme-theme/theme.json
  - wp-content/themes/smartvarme-theme/src/style.scss
  - wp-content/themes/smartvarme-theme/src/editor.scss
autonomous: true

must_haves:
  truths:
    - "Typography scales fluidly between mobile (320px) and desktop (1440px) without media queries"
    - "Spacing is consistent across all page types using design token variables"
    - "Buttons, links, headings, and form elements have consistent styling from theme.json"
    - "Editor preview matches frontend appearance for typography and spacing"
    - "Site uses system font stack for zero-latency text rendering (no CLS from font loading)"
  artifacts:
    - path: "wp-content/themes/smartvarme-theme/theme.json"
      provides: "Complete design system with fluid typography, spacing scale, element styles, block styles"
      contains: "\"fluid\": true"
    - path: "wp-content/themes/smartvarme-theme/src/style.scss"
      provides: "Mobile-first responsive CSS with breakpoints at 768px and 1440px"
      contains: "@media (min-width: 768px)"
    - path: "wp-content/themes/smartvarme-theme/src/editor.scss"
      provides: "Editor styles matching frontend appearance"
      contains: "wp-block-post-content"
  key_links:
    - from: "theme.json"
      to: "style.scss"
      via: "CSS custom properties (--wp--preset--*)"
      pattern: "var\\(--wp--preset--"
---

<objective>
Enhance the existing minimal theme.json into a complete design system with fluid typography, 8px-based spacing scale, comprehensive element styles (buttons, links, headings), and block-level styles. Restructure style.scss as mobile-first responsive CSS using theme.json CSS variables instead of hard-coded values.

Purpose: Establishes the visual foundation (UX-01, UX-02, UX-03) that all other Phase 5 work builds on. Fluid typography eliminates ~70% of responsive CSS needs. Design tokens enforce consistency across blog, product, FAQ, and checkout pages.

Output: Enhanced theme.json + restructured style.scss + editor.scss
</objective>

<execution_context>
@/Users/salesup/.claude/get-shit-done/workflows/execute-plan.md
@/Users/salesup/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-design-user-experience/05-RESEARCH.md
@wp-content/themes/smartvarme-theme/theme.json
@wp-content/themes/smartvarme-theme/src/style.scss
@wp-content/themes/smartvarme-theme/src/editor.scss
@wp-content/themes/smartvarme-theme/parts/header.html
@wp-content/themes/smartvarme-theme/parts/footer.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance theme.json with complete design system</name>
  <files>wp-content/themes/smartvarme-theme/theme.json</files>
  <action>
Enhance the existing theme.json (version 3) with the following additions. Preserve all existing settings (color palette, layout sizes) and ADD/MODIFY:

**Typography settings — add fluid sizing to each font size preset:**
- "small": 0.875rem, fluid: false (fixed small text)
- "medium": 1rem, fluid: { min: "0.875rem", max: "1rem" }
- "large": 1.25rem → 1.5rem, fluid: { min: "1.125rem", max: "1.5rem" }
- "x-large": 1.5rem → 2.25rem, fluid: { min: "1.5rem", max: "2.25rem" }
- "xx-large": 2.25rem → 3rem, fluid: { min: "2rem", max: "3rem" }
- Keep `"fluid": true` and `"customFontSize": false` already set
- Add `"fontFamilies"` with system font stack:
  ```json
  {
    "slug": "system",
    "fontFamily": "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif",
    "name": "System"
  }
  ```

**Spacing settings — replace current 3-step spacingSizes with 7-step scale:**
Replace the existing `spacingSizes` array with `spacingScale` configuration:
```json
"spacingScale": {
  "operator": "*",
  "increment": 1.5,
  "steps": 7,
  "mediumStep": 1.5,
  "unit": "rem"
}
```
Remove `spacingSizes` array (spacingScale generates it automatically). Keep `"customSpacingSize": false`.
Add `"blockGap": true` to spacing settings.

**Styles section — add comprehensive element and block styles:**

Root styles:
- typography.fontFamily: "var(--wp--preset--font-family--system)"
- spacing.padding: top/bottom "0", left/right "var(--wp--preset--spacing--50)"
- spacing.blockGap: "var(--wp--preset--spacing--50)"

Element styles:
- `button`: background gold, text primary (#1a1a1a), fontSize medium, fontWeight 600, padding 0.75rem/1.5rem, border-radius 4px, `:hover` background #e89610
- `link`: color gold, `:hover` color accent (#e63946), textDecoration "underline"
- `heading`: fontWeight 700, lineHeight "1.2", fontFamily system, spacing.margin.bottom "var(--wp--preset--spacing--40)"
- `caption`: fontSize small, color secondary

Block styles:
- `core/paragraph`: spacing.margin.bottom "var(--wp--preset--spacing--40)"
- `core/image`: border.radius "8px"
- `core/separator`: color.text secondary, border.color secondary, border.width "1px"
- `core/columns`: spacing.blockGap "var(--wp--preset--spacing--50)"
- `core/button`: keep existing, add `variations.outline` with transparent background, gold text, gold 2px border
- `core/post-title`: typography.fontWeight "700"
- `core/site-title`: typography.fontSize "x-large", typography.fontWeight "700"
- `core/navigation`: typography.fontSize "medium"
- `core/group` with class `.smartvarme-product`: no custom styles needed (CSS handles)

Do NOT change: color palette slugs/values, layout contentSize/wideSize, version number.
  </action>
  <verify>
Run: `cd wp-content/themes/smartvarme-theme && cat theme.json | python3 -m json.tool > /dev/null && echo "Valid JSON"` to confirm valid JSON.
Verify fluid typography: `grep -c '"fluid"' theme.json` returns at least 5 (one global + 4 per-size).
Verify spacing scale: `grep '"spacingScale"' theme.json` finds the spacingScale config.
Verify element styles: `grep '"button"' theme.json` and `grep '"heading"' theme.json` find element styles.
  </verify>
  <done>
theme.json contains: fluid typography with min/max per font size, spacingScale generating 7 spacing steps, system font family, button/link/heading/caption element styles, block-level styles for paragraph/image/separator/columns/button, outline button variation. JSON is valid.
  </done>
</task>

<task type="auto">
  <name>Task 2: Restructure style.scss as mobile-first responsive CSS</name>
  <files>
wp-content/themes/smartvarme-theme/src/style.scss
wp-content/themes/smartvarme-theme/src/editor.scss
  </files>
  <action>
Rewrite style.scss as mobile-first responsive CSS. The goal is to replace hard-coded values with CSS variables from theme.json, remove unnecessary `!important` overrides, and organize into clear responsive sections.

**Structure the file in this order:**

1. **Reset/Base** (mobile-first, 320px+):
   - Remove the body font-family/font-size/line-height/color/background rules (now handled by theme.json)
   - Keep img max-width: 100% and height: auto
   - Remove the `a` color rule (now handled by theme.json link element style)
   - Remove h1-h6 margin rules (now handled by theme.json heading element style)
   - Keep .alignfull and .alignwide rules as-is
   - Keep .wp-site-blocks padding: 0 and max-width: none

2. **Header styles** (keep header constraint rule as-is)

3. **Button overrides** — Dramatically simplify. theme.json now handles core button styles.
   - Keep ONLY WooCommerce-specific button selectors that need gold override:
     `.woocommerce #respond input#submit, .woocommerce a.button, .woocommerce button.button, .woocommerce input.button`
   - Use CSS variables: `background-color: var(--wp--preset--color--gold)`, `color: var(--wp--preset--color--primary)`
   - Remove ALL Kadence button selectors (.kb-btn, .kb-button, .kadence-btn, etc.) — Kadence is no longer used
   - Remove `!important` where possible (keep only on WooCommerce selectors that truly need it)
   - Keep outline button style as-is

4. **FAQ accordion styles** — Keep as-is (already uses CSS variables)

5. **Blog card styles** — Keep as-is (already uses CSS variables)

6. **WooCommerce product grid** — Keep as-is (already responsive with breakpoints)

7. **Single product page** — Keep .smartvarme-product section as-is

8. **Stock/delivery info** — Keep as-is

9. **Shop/archive** — Keep .smartvarme-shop section. Replace hard-coded padding value `1.5rem` with `var(--wp--preset--spacing--50)` where appropriate.

10. **Responsive breakpoints section** — Add a clearly commented section at the end:
```scss
/* ============================================
   Responsive Breakpoints
   Mobile-first: base styles above are for 320px+
   Only layout changes that theme.json cannot handle
   ============================================ */

// Tablet (768px+)
@media (min-width: 768px) {
  .wp-site-blocks {
    padding-left: var(--wp--preset--spacing--50);
    padding-right: var(--wp--preset--spacing--50);
  }
}

// Desktop (1440px+)
@media (min-width: 1440px) {
  .wp-site-blocks {
    padding-left: var(--wp--preset--spacing--60);
    padding-right: var(--wp--preset--spacing--60);
  }
}

// Reduced motion accessibility
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

**Editor styles (editor.scss):**
Add basic editor matching styles:
```scss
/* Editor styles - match frontend appearance */
.editor-styles-wrapper {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;

  .wp-block-post-content {
    max-width: 1140px;
    margin: 0 auto;
  }

  // Match FAQ accordion styles in editor
  .wp-block-details {
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    margin-bottom: 0.5rem;

    summary {
      padding: 1rem 1.25rem;
      font-weight: 600;
      background-color: #f8f9fa;
    }
  }
}
```

**Key cleanup rules:**
- Every `!important` that can be removed, remove it. Only keep `!important` on WooCommerce button selectors (WooCommerce's own CSS specificity requires it) and grid display overrides
- Replace every hard-coded color (#f7a720, #1a1a1a, #767676, #f8f9fa, #e63946) with its CSS variable equivalent
- Replace hard-coded spacing values (1rem, 2rem, etc.) with spacing variables where a clear match exists (but keep component-internal spacing like 0.5rem padding as-is — not every value needs a variable)
  </action>
  <verify>
Run the build: `cd wp-content/themes/smartvarme-theme && npx @wordpress/scripts build` — must complete without errors.
Check CSS variable usage: `grep -c 'var(--wp--preset' src/style.scss` should return 15+ (increased from current ~15).
Check !important reduction: `grep -c '!important' src/style.scss` should be lower than current count (currently ~20, target under 12).
Check Kadence selectors removed: `grep -c 'kadence\|kb-btn\|kb-button' src/style.scss` should return 0.
  </verify>
  <done>
style.scss is restructured mobile-first with CSS variables replacing hard-coded values, Kadence selectors removed, !important usage minimized, responsive breakpoints section added (768px, 1440px), reduced-motion accessibility media query added. editor.scss provides basic editor matching. Build compiles successfully.
  </done>
</task>

</tasks>

<verification>
1. theme.json is valid JSON with fluid typography, spacingScale, element styles, block styles
2. style.scss compiles via @wordpress/scripts without errors
3. CSS variables from theme.json are used throughout style.scss (no hard-coded colors where variables exist)
4. Kadence-related selectors fully removed
5. Mobile-first responsive structure with breakpoints at 768px and 1440px
6. Reduced-motion accessibility media query present
7. Editor styles provide basic frontend matching
</verification>

<success_criteria>
- theme.json defines complete design system: fluid typography (5 sizes with min/max), spacing scale (7 steps), system font family, element styles (button, link, heading, caption), block styles (paragraph, image, separator, columns, button variations)
- style.scss is mobile-first, uses CSS variables, has reduced Kadence and !important bloat
- Build compiles without errors
- Editor preview has basic matching styles
</success_criteria>

<output>
After completion, create `.planning/phases/05-design-user-experience/05-01-SUMMARY.md`
</output>
